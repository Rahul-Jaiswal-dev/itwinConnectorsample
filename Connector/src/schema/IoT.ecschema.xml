<?xml version="1.0" encoding="UTF-8"?>
<ECSchema schemaName="IoT" alias="iot" version="01.00.00" xmlns="http://www.bentley.com/schemas/Bentley.ECXML.3.1" description="The IoT schema defines common base classes to be used for IoT sensor devices.">

    <ECSchemaReference name="CoreCustomAttributes" version="01.00.03" alias="CoreCA"/>
    <ECSchemaReference name="BisCore" version="01.00.12" alias="bis"/>
    <ECSchemaReference name="Functional" version="01.00.03" alias="func"/>   

    <ECCustomAttributes>
        <ProductionStatus xmlns="CoreCustomAttributes.01.00.03">
            <SupportedUse>NotForProduction</SupportedUse>
        </ProductionStatus>
    </ECCustomAttributes>    

    <ECEntityClass typeName="Device" modifier="Abstract" displayLabel="Device" description="A iot:Device models an IoT sensor device Entity which will not be sub-modeled at a finer granularity and does not have 'child' parts.">
        <BaseClass>FunctionalComponentElement</BaseClass>
        <ECProperty propertyName="Deviceid" typeName="string" />
        <ECProperty propertyName="Devicetype" typeName="string" />
        <ECProperty propertyName="type_of_quantity_observed" typeName="string" />
        <ECProperty propertyName="units_for_quantities_being_observed" typeName="string" />   
    </ECEntityClass>

     <ECEntityClass typeName="Datapoint" modifier="Abstract" displayLabel="Datapoint" description="A iot:Datapoint models an IoT sensor device Entity.">
        <BaseClass>FunctionalComponentElement</BaseClass>        
    </ECEntityClass>

    <ECEntityClass typeName="ObservableDatapoint" modifier="Abstract" displayLabel="ObservableDatapoint" description="A iot:ObservableDatapoint models an IoT sensor device Entity.">
        <BaseClass>Datapoint</BaseClass>  
        <ECProperty propertyName="Name" typeName="string" />
        <ECProperty propertyName="Unit" typeName="string" />     
    </ECEntityClass>

    <ECEntityClass typeName="TemperatureDatapoint" modifier="Abstract" displayLabel="ObservableDatapoint" description="A iot:ObservableDatapoint models an IoT sensor device Entity.">
        <BaseClass>ObservableDatapoint</BaseClass>       
    </ECEntityClass>

    <ECEntityClass typeName="PressureDatapoint" modifier="Abstract" displayLabel="ObservableDatapoint" description="A iot:ObservableDatapoint models an IoT sensor device Entity.">
        <BaseClass>ObservableDatapoint</BaseClass>       
    </ECEntityClass>

    <ECRelationshipClass typeName="DatapointObservesSpatialElement" strength="referencing" modifier="None" description="Relates func:FunctionalElement instances (which model a required function) to the bis:PhysicalElement instances that model the physical Entity that fulfills the function." >
        <BaseClass>bis:ElementRefersToElements</BaseClass>
        <Source multiplicity="(0..1)" roleLabel="observes" polymorphic="true">
            <Class class="ObservableDatapoint"/>
        </Source>
        <Target multiplicity="(0..*)" roleLabel="is observed by" polymorphic="true">
            <Class class="bis:SpatialElement"/>
        </Target>
    </ECRelationshipClass>
</ECSchema>
